<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="keywords" content=""/>
		<meta name="description" content=""/>		
	    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"/>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge，chrome=1">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
	    <title>测试收集项711</title>
	    <link href="https://cdn.bootcss.com/framework7/1.6.5/css/framework7.ios.min.css" rel="stylesheet">
	    <link rel="stylesheet" href="http://weike.staff.xdf.cn/public/collection/css/MobileStyle6_1.css" type="text/css"/>
	    <script src="http://file.xdf.cn/diy/public/js/jquery.1.7.2.min.js"></script>
		<script src="http://weike.staff.xdf.cn/public/gouke/app/js/layer/layer.js" type="text/javascript"></script>
    	<link rel="stylesheet" href="http://weike.staff.xdf.cn/public/gouke/app/js/layer/skin/layer.css">
    	<style type="text/css">
			.con_p.a input[type="radio"]:checked+label {
				background: url(http://weike.staff.xdf.cn/public/collection/images/MobileImg/yuan.png) no-repeat left center;
				background-size: contain;
			}
			label {
				padding-left: 1.2rem;
				cursor: pointer;
				background: url(http://weike.staff.xdf.cn/public/collection/images/MobileImg/yuan1.png) no-repeat left center;
				background-size: contain;
				font-size: .85rem;
			}

			.choice .choice-box1 {
				background: url(http://weike.staff.xdf.cn/public/collection/images/MobileImg/zx.jpg) no-repeat left top;
				background-size: contain;
				display: inline-block;
				color: #9a9a9a;
				font-size: .6rem;
				padding-left: 1.2rem;
			}
			.choice #userlicense_check:checked + .choice-box1 {
				background: url(http://weike.staff.xdf.cn/public/collection/images/MobileImg/xz1.jpg) no-repeat left top;
				background-size: contain; 
			}
		</style>
	</head>
	<body style="overflow:auto">
		<div class="warp_all">	
			<div class="warp warp_pc">
			<div class="banner">
				<img src="http://weike.staff.xdf.cn/public/collection/images/MobileImg/bannerwx.jpg" alt="" />
				<div class="badw">
					<div class="part1">
					<p class="bt">{$kw}</p>
					<p class="bt">验证码:{$text.data}</p>
					<p class="bt a">有效期:{$text.time}</p>
					</div>
				</div>
			</div>
			
			<div class="part1a">
					<form action="" class="form" id="clform">
						<p class="con_p">
							<span class="con_span">姓名</span>
							<input type="text" id="name" name="name" placeholder="请输入姓名"/>
						</p>
						<p class="con_p">
							<span class="con_span">手机号</span>
							<input type="text" id="mobile" name="mobile" placeholder="请输入手机号"/>
							<input type="button" value="发送验证" id='btn1'>
						</p>
						<p class="con_p">
							<span class="con_span">邮箱</span>
							<input type="text" id="email" name="email" placeholder="请输入邮箱"/>
						</p>
						<div class="con_p a">
							<span class="con_span">性别</span>
							<p class="contxb">
								<input type="radio" name="gender"  id="gender_0"  value="1" checked="checked">
								<label name="fc_gender_lab" for="gender_0" >男</label>
	
								<input type="radio" name="gender"  id="gender_1"  value="0" >
								<label name="fc_gender_lab" for="gender_1"  style="margin-left:0.5rem;">女</label>
							</p>
						</div>
						<div class="con_p b">
							<span class="con_span">出生日期</span>
							<input  type="date" name="birthday" placeholder="" >
						</div>
						<p class="con_p b">
							<span class="con_span">年龄</span>
							<select name="age" id="age"  class="set">
								<span style="text-align: center;"></span>
									<option value="8">8</option>
									<option value="9">9</option>
									<option value="10">10</option>
									<option value="11">11</option>
									<option value="12">12</option>
								</select>
						</p>
						<div class="con_p b">
							<span class="con_span">行政区</span>
							<input type="text" id="location" name="pmc" placeholder="    "/>
						</div>
						<p style="width:100%;height:.5rem;background:#ededed;"></p>
						<div class="con_p gr">
							<span class="con_span a">多行</span>
							<textarea name="textarea8" rows="" cols="" placeholder="请输入多行" class="area"></textarea>
						</div>
						<p class="con_p b">
							<span class="con_span">多选框<span class="zdkx">(多选可选3个)</span></span>
							<input type="text" class="jtzz a" id="checkbox9"  name="checkbox9" placeholder=""/>						
						</p>
						<div class="tc" id="pop_checkbox9" >
							<div class="tc_a">
								<ul class="qxqd">
										<li class="qx">取消</li>
										<li class="qd">确定</li>
								</ul>
								<ul class="dxk" id="checkbox9_dxk">
									<li>多1</li>
									<li>多2</li>
									<li>多3</li>
									<li>多4</li>
									<li>多5</li>
								</ul>								
							</div>
						</div>
						<p style="width:100%;height:.5rem;background:#ededed;"></p>
						<!-- <div class="con_p d">
							<span class="con_span" style="width:30%;">图片1上传</span><span class="sfz">请上传图片</span>
							<div class="sc_sfz">
								<input type="file" id="imgUploadBtn"  style="opticy:0;" accept=“image/*”onChange="handleInputChange();"/> 
								<input type="hidden" name="image" id="image" /> 
								<img src="http://weike.staff.xdf.cn/public/collection/images/MobileImg/sfz.png" alt=""   id="img_preview"/>
							</div>
						</div>															 -->
						<div class="choice">
							<p class="choicea">
								<input type="checkbox" name="fc_question" id="userlicense_check" style="display: none;">
								<label for="userlicense_check" class="choice-box1">我已阅读并同意《<a href="/collection/userlicense" onclick="javascript: window.location.href='userlicense';" >用户服务条款</a>》和 《<a href="/collection/privacypolicy" onclick="javascript: window.location.href='privacypolicy';" >隐私政策</a>》</label>
							</p>        
						</div>
						<div class="btn">
							<input type="button" name="" id="submitbtn" value="提交按钮"  class="tijiao"  style="background:#e57a3e;"/>
						</div>
					</form>
				</div>
			</div>
		</div>		
		<script type="text/javascript">

			$("#submitbtn").click(function(event){
				// alert(111);
				console.log($('form').serializeArray());
				$.post('/collection/test2',{status:1,data:$('form').serializeArray()},function(msg){
					console.log(msg);
				});
				event.preventDefault();
				event.stopPropagation();
			});

			$("#btn1").click(function(){
				console.log($("#mobile").attr('value'));
				$.post('/collection/test2',{status:2,data:$("#mobile").attr('value')},function(msg){
					console.log(msg);
				});
			});


			const imgFile = {};				
			var limit=3;
			if(parseInt('3')>0){
				limit=parseInt('3');
			}
			$("#checkbox9").focus(function(){	
				$("#pop_checkbox9").show();
				$("#pop_checkbox9 .tc_a").animate({"bottom":"0px"},300,function(){})
			});
			$("#pop_checkbox9 .qx").click(function(){  
				$("#pop_checkbox9").hide();
			});
			$("#pop_checkbox9 .qd").click(function(){  
				$("#pop_checkbox9 .tc_a").animate({"bottom":"-100%"},500,function(){    
					var newv='';
					$("#checkbox9").val(newv);
					$('ul#checkbox9_dxk .active').each(function(){
						if($("#checkbox9").val()=='')
							$("#checkbox9").val($(this).text());
						else{
							newv=$("#checkbox9").val()+","+$(this).text();
							$("#checkbox9").val(newv);
						}
					});
					$("#pop_checkbox9").hide();
				});                  	
			});
	
			function handleInputChange (e) {
				// 获取当前选中的文件
				//alert(JSON.stringify(event))
				var event = e || window.event;
				const file = event.target.files[0];
				const imgMasSize = 1024 * 1024 * 4; // 10MB
				// 检查文件类型
				if(['jpeg', 'png', 'gif', 'jpg'].indexOf(file.type.split("/")[1]) < 0){
					// 自定义报错方式
					layer.msg("文件类型仅支持 jpeg/png/gif！");
					return;
				}
				// 文件大小限制
				if(file.size > imgMasSize ) {
					// 文件大小自定义限制
					layer.msg("文件大小不能超过4MB！");
					return;
				}
				// 判断是否是ios
				transformFileToFormData(file);	
			}
			function transformFileToFormData (file) {
				const formData = new FormData();
				// 自定义formData中的内容
				// type
				formData.append('type', file.type);
				// size
				formData.append('size', file.size || "image/jpeg");
				// name
				formData.append('name', file.name);
				// lastModifiedDate
				formData.append('lastModifiedDate', file.lastModifiedDate);
				// append 文件
				formData.append('file', file);
				// 上传图片
				uploadImg(formData);
			}
			function uploadImg (formData) {		
				var xhr = new XMLHttpRequest();
				xhr.onReadyStateChange = function () {
					if (xhr.readyState === 4) {
						const result = JSON.parse(xhr.responseText);
						if (xhr.status === 200) {
							if(result.errno==0){
								$('#img_preview').css("display","none");
								var bg="http://weike.staff.xdf.cn/public/uploads/collection/"+result.data.path;
								$('.sc_sfz').css("background","url("+bg+")");
								$('.sc_sfz').css("background-size","cover");
								$('#image').val(result.data.path);
							}else{
								layer.msg(result.msg);
							}
						} else {
							// 上传失败
						}
					}
				};
				xhr.open('POST', 'ajax_collectionuploadfile?id=ff24932040aafbcd336996adbe8ce3d5' , true);
				xhr.send(formData);
			}		
			$('.dxk li').click(function(e){
				if($(this).hasClass('active')){
					$(this).removeClass('active');
				}else{
					var num=$('ul#image_dxk .active').length;
					if(num>=limit){
						layer.msg('图片1上传限选'+limit+'项');
						return false;
					}else{
						$(this).addClass('active');
					}
				}	
			});
			$("#submitbtn").click(function(){
					var data=new Object();
					data.id='ff24932040aafbcd336996adbe8ce3d5';
					var agreed=$('#userlicense_check').prop("checked");
					if(!agreed){
						layer.msg('请先同意用户服务条款!');
						return false;
					}
					
					var name=  $("*[name='name']").val();
					data.name=name;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					// if(name=='' || name==undefined){
					// 	layer.msg('姓名'+'不能为空!');
					// 	return false;
					// }
									
					// var mobile=  $("*[name='mobile']").val();
									
					data.mobile=mobile;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(mobile=='' || mobile==undefined){
					// 	layer.msg('手机号'+'不能为空!');
					// 	return false;
					// }
									
					// var email=  $("*[name='email']").val();
									
					data.email=email;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(email=='' || email==undefined){
					// 	layer.msg('邮箱'+'不能为空!');
					// 	return false;
					// }
									
					// var gender=  $("*[name='gender']:checked").val();
									
					data.gender=gender;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(gender=='' || gender==undefined){
					// 	layer.msg('性别'+'不能为空!');
					// 	return false;
					// }
									
					// var birthday=  $("*[name='birthday']").val();
									
					data.birthday=birthday;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(birthday=='' || birthday==undefined){
					// 	layer.msg('出生日期'+'不能为空!');
					// 	return false;
					// }
									
					// var age=  $("*[name='age']").val();
									
					// data.age=age;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(age=='' || age==undefined){
					// 	layer.msg('年龄'+'不能为空!');
					// 	return false;
					// }
									
					// var pmc=  $("*[name='pmc']").val();
									
					// data.pmc=pmc;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(pmc=='' || pmc==undefined){
					// 	layer.msg('行政区'+'不能为空!');
					// 	return false;
					// }
									
					// var textarea8=  $("*[name='textarea8']").val();
									
					// data.textarea8=textarea8;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(textarea8=='' || textarea8==undefined){
					// 	layer.msg('多行'+'不能为空!');
					// 	return false;
					// }
									
					// var checkbox9=  $("*[name='checkbox9']").val();
									
					// data.checkbox9=checkbox9;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(checkbox9=='' || checkbox9==undefined){
					// 	layer.msg('多选框'+'不能为空!');
					// 	return false;
					// }
									
					// var image=  $("*[name='image']").val();
									
					// data.image=image;
					// if($("#image")!=undefined){
					// 	data.image=$("#image").val();
					// }
					
					// if(image=='' || image==undefined){
					// 	layer.msg('图片1上传'+'不能为空!');
					// 	return false;
					// }

					// $.post("ajax_collectionsubmit",data).success(function(data){
					// 	if(data.errno!=0){
					// 		layer.msg(data.msg);
					// 	}else{
					// 		layer.msg(data.msg);
					// 		$('#content').val("");
					// 		$('#result').html("0");
					// 		if(data.redirect !=undefined){
					// 			window.location.href=data.redirect;
					// 		}
					// 	}
					// });
				});	
		</script>  
		<script type="text/javascript" src="http://weike.staff.xdf.cn/public/collection/js/framework7.min.js"></script>
		<script type="text/javascript" src="http://weike.staff.xdf.cn/public/collection/js/district.js"></script>
		<script type="text/javascript">
			;(function(window,$,undefined){
				function getProvince(regions){  
					return regions['provincesArr'];  
				}
				function getCity(regions,provinceName){
					return regions['provinces'][provinceName]['citiesArr'];
				}
				function getArea(regions,provinceName,cityName){
					return regions['provinces'][provinceName]['cities'][cityName]['areasArr'];
				}
				var myApp=new Framework7();
				var province=getProvince(regions),
							city=getCity(regions,'北京市'),
							area=getArea(regions,'北京市','北京市');
				var provinceSelect='';
				var pickerLocation=myApp.picker({
					input:'#location',
					rotateEffect:true,
					toolbarTemplate:'<div class="toolbar">\<div class="toolbar-inner">\<div class="left">\<a href="#" class="link close-picker">取消</a>\</div>\<div class="right">\<a href="#" class="link close-picker">完成</a>\</div>\</div>\</div>',
					cols:[{
						cssClass:'f-s-14',
						width:'33.33%',
						textAlign:'left',
						values:province,
						onChange:function(picker,province){
							if(picker.cols[1].replaceValues){
								provinceSelect=province;
								city=getCity(regions,province);
								area=getArea(regions,province,city[0]);
								picker.cols[1].replaceValues(city);
								if(area.length!==0){
									picker.cols[2].replaceValues(area);
								}else{
									picker.cols[2].replaceValues(city);
								}
							}
						}
					},{
						cssClass:'f-s-14',
						width:'33.33%',
						textAlign:'center',
						values:city,
						onChange:function(picker,city){
							if(picker.cols[2].replaceValues){
								area=getArea(regions,provinceSelect,city);
								if(area.length!==0){
									picker.cols[2].replaceValues(area);
								}else{
									picker.cols[2].replaceValues([city]);
								}
							}
						}
					},{
						cssClass:'f-s-14',
						width:'33.33%',
						textAlign:'right',
						values:area,
					}]
				});
			})(window,jQuery);
		</script>
	</body>
</html>
